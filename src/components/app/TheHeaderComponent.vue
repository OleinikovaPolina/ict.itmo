<template>
  <div class="navbar-container app-background">
    <v-container>
      <v-row
        class="d-flex align-center"
        style="background-color: inherit; box-shadow: none"
      >
        <div class="pa-3 pr-lg-8 pr-xl-12">
          <router-link to="/">
            <svg
              class="logo"
              viewBox="0 0 573 279"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M103.885 148.725L27.587 176.116L103.902 242.843L103.885 148.725Z"
                fill="url(#paint0_linear_277:1953)"
              />
              <path
                d="M168.032 126.396L27.5844 176.118V68.0075L168.032 18.2859V126.396Z"
                fill="url(#paint1_linear_277:1953)"
              />
              <path
                d="M170.967 128.899L247.265 101.508L170.95 34.7815L170.967 128.899Z"
                fill="url(#paint2_linear_277:1953)"
              />
              <path
                d="M106.819 151.227L247.268 101.506V209.617L106.819 259.339V151.227Z"
                fill="url(#paint3_linear_277:1953)"
              />
              <mask
                id="mask0_277:1953"
                style="mask-type:alpha"
                maskUnits="userSpaceOnUse"
                x="168"
                y="34"
                width="77"
                height="95"
              >
                <path
                  d="M168.05 128.899L244.348 101.508L168.032 34.7815L168.05 128.899Z"
                  fill="url(#paint4_linear_277:1953)"
                />
              </mask>
              <g mask="url(#mask0_277:1953)">
                <path
                  d="M166.691 143.009C159.857 127.498 135.378 116.019 160.669 104.887C185.959 93.7549 255.211 89.3757 262.045 104.887C268.881 120.398 241.165 156.958 215.873 168.09C190.584 179.222 173.525 158.521 166.691 143.009Z"
                  fill="url(#paint5_radial_277:1953)"
                  fill-opacity="0.25"
                />
              </g>
              <mask
                id="mask1_277:1953"
                style="mask-type:alpha"
                maskUnits="userSpaceOnUse"
                x="27"
                y="148"
                width="77"
                height="95"
              >
                <path
                  d="M103.885 148.725L27.587 176.116L103.902 242.843L103.885 148.725Z"
                  fill="url(#paint6_linear_277:1953)"
                />
              </mask>
              <g mask="url(#mask1_277:1953)">
                <path
                  d="M105.244 134.614C112.078 150.126 136.556 161.605 111.266 172.737C85.9753 183.869 16.7236 188.249 9.8891 172.737C3.05467 157.226 30.7701 120.666 56.0608 109.534C81.3513 98.4017 98.4092 119.103 105.244 134.614Z"
                  fill="url(#paint7_radial_277:1953)"
                  fill-opacity="0.25"
                />
              </g>
              <path
                d="M293.688 189C292.728 189 291.912 188.664 291.24 187.992C290.568 187.32 290.232 186.456 290.232 185.4V91.8C290.232 90.744 290.568 89.88 291.24 89.208C291.912 88.536 292.776 88.2 293.832 88.2H306.792C307.848 88.2 308.664 88.536 309.24 89.208C309.912 89.88 310.248 90.744 310.248 91.8V157.896L357.624 90.504C358.008 90.024 358.536 89.544 359.208 89.064C359.88 88.488 360.744 88.2 361.8 88.2H373.752C374.712 88.2 375.528 88.536 376.2 89.208C376.872 89.88 377.208 90.744 377.208 91.8V185.544C377.208 186.504 376.872 187.32 376.2 187.992C375.528 188.664 374.712 189 373.752 189H360.792C359.736 189 358.872 188.664 358.2 187.992C357.528 187.32 357.192 186.504 357.192 185.544V120.744L309.96 186.696C309.672 187.08 309.192 187.56 308.52 188.136C307.848 188.712 306.936 189 305.784 189H293.688ZM403.094 189C402.134 189 401.318 188.712 400.646 188.136C399.974 187.464 399.638 186.6 399.638 185.544V91.8C399.638 90.744 399.974 89.88 400.646 89.208C401.318 88.536 402.134 88.2 403.094 88.2H416.198C417.254 88.2 418.07 88.536 418.646 89.208C419.318 89.88 419.654 90.744 419.654 91.8V128.952H432.182L455.654 90.792C456.134 90.024 456.758 89.4 457.526 88.92C458.39 88.44 459.494 88.2 460.838 88.2H475.094C476.054 88.2 476.774 88.488 477.254 89.064C477.83 89.64 478.118 90.36 478.118 91.224C478.118 91.704 477.926 92.28 477.542 92.952L450.326 136.872L480.134 184.104C480.422 184.392 480.566 184.92 480.566 185.688C480.566 186.552 480.23 187.32 479.558 187.992C478.982 188.664 478.214 189 477.254 189H462.422C461.174 189 460.214 188.712 459.542 188.136C458.966 187.56 458.486 187.032 458.102 186.552L432.902 146.952H419.654V185.544C419.654 186.504 419.318 187.32 418.646 187.992C418.07 188.664 417.254 189 416.198 189H403.094ZM521.739 189C520.779 189 519.963 188.664 519.291 187.992C518.619 187.32 518.283 186.504 518.283 185.544V105.912H491.643C490.683 105.912 489.867 105.576 489.195 104.904C488.523 104.232 488.187 103.416 488.187 102.456V91.8C488.187 90.744 488.523 89.88 489.195 89.208C489.867 88.536 490.683 88.2 491.643 88.2H565.083C566.139 88.2 567.003 88.536 567.675 89.208C568.347 89.88 568.683 90.744 568.683 91.8V102.456C568.683 103.416 568.347 104.232 567.675 104.904C567.003 105.576 566.139 105.912 565.083 105.912H538.587V185.544C538.587 186.504 538.251 187.32 537.579 187.992C536.907 188.664 536.043 189 534.987 189H521.739Z"
                fill="url(#paint8_linear_277:1953)"
              />
              <defs>
                <linearGradient
                  id="paint0_linear_277:1953"
                  x1="154.609"
                  y1="230.903"
                  x2="43.8175"
                  y2="154.105"
                  gradientUnits="userSpaceOnUse"
                >
                  <stop stop-color="#2DC0C5" />
                  <stop
                    offset="1"
                    stop-color="#2E9CEF"
                  />
                </linearGradient>
                <linearGradient
                  id="paint1_linear_277:1953"
                  x1="27.5844"
                  y1="97.2019"
                  x2="168.032"
                  y2="97.2019"
                  gradientUnits="userSpaceOnUse"
                >
                  <stop stop-color="#2DC0C5" />
                  <stop
                    offset="1"
                    stop-color="#2E9CEF"
                  />
                </linearGradient>
                <linearGradient
                  id="paint2_linear_277:1953"
                  x1="120.243"
                  y1="46.7208"
                  x2="231.035"
                  y2="123.519"
                  gradientUnits="userSpaceOnUse"
                >
                  <stop stop-color="#2DC0C5" />
                  <stop
                    offset="1"
                    stop-color="#2E9CEF"
                  />
                </linearGradient>
                <linearGradient
                  id="paint3_linear_277:1953"
                  x1="247.268"
                  y1="180.423"
                  x2="106.819"
                  y2="180.423"
                  gradientUnits="userSpaceOnUse"
                >
                  <stop stop-color="#2DC0C5" />
                  <stop
                    offset="1"
                    stop-color="#2E9CEF"
                  />
                </linearGradient>
                <linearGradient
                  id="paint4_linear_277:1953"
                  x1="117.326"
                  y1="46.7208"
                  x2="228.118"
                  y2="123.519"
                  gradientUnits="userSpaceOnUse"
                >
                  <stop stop-color="#2DC0C5" />
                  <stop
                    offset="1"
                    stop-color="#2E9CEF"
                  />
                </linearGradient>
                <radialGradient
                  id="paint5_radial_277:1953"
                  cx="0"
                  cy="0"
                  r="1"
                  gradientUnits="userSpaceOnUse"
                  gradientTransform="translate(202.262 130.083) rotate(-121.239) scale(31.8149 51.8589)"
                >
                  <stop />
                  <stop
                    offset="1"
                    stop-opacity="0"
                  />
                </radialGradient>
                <linearGradient
                  id="paint6_linear_277:1953"
                  x1="154.609"
                  y1="230.903"
                  x2="43.8175"
                  y2="154.105"
                  gradientUnits="userSpaceOnUse"
                >
                  <stop stop-color="#2DC0C5" />
                  <stop
                    offset="1"
                    stop-color="#2E9CEF"
                  />
                </linearGradient>
                <radialGradient
                  id="paint7_radial_277:1953"
                  cx="0"
                  cy="0"
                  r="1"
                  gradientUnits="userSpaceOnUse"
                  gradientTransform="translate(69.673 147.542) rotate(58.7608) scale(31.8149 51.8588)"
                >
                  <stop />
                  <stop
                    offset="1"
                    stop-opacity="0"
                  />
                </radialGradient>
                <linearGradient
                  id="paint8_linear_277:1953"
                  x1="279"
                  y1="103.373"
                  x2="517.234"
                  y2="187.729"
                  gradientUnits="userSpaceOnUse"
                >
                  <stop stop-color="#2E9FED" />
                  <stop
                    offset="1"
                    stop-color="#2DBDC9"
                  />
                </linearGradient>
              </defs>
            </svg>
          </router-link>
        </div>

        <v-col
          v-if="$vuetify.breakpoint.mdAndUp"
          class="d-flex align-center"
        >
          <template
            v-for="(link,i) in links"
          >
            <router-link
              v-if="i!==3"
              :key="i"
              :to="'/'+link.path"
              class="header-link mr-2 mr-lg-4  mr-xl-8"
              :class="link.name.filter(x=>x===$route.name).length>0?'link--active':''"
            >
              {{ link.text }}
            </router-link>
            <div
              v-else
              :key="i"
              class="text-center"
            >
              <v-menu
                offset-y
                class="ict-dropdown"
                rounded="b-xl"
                nudge-left="15"
              >
                <template #activator="{ on,attrs }">
                  <div
                    class="header-link mr-2 mr-lg-4 mr-xl-8 d-flex align-center"
                    v-bind="attrs"
                    v-on="on"
                  >
                    <span
                      class="pr-1"
                      :class="['baccalaureate','magistracy','program','disciplines'].filter(x=>x===$route.name).length>0?'link--active':''"
                    >Поступление</span>
                    <div
                      class="dropdown-symbol"
                      :style="{transform: attrs['aria-expanded']==='true'?'rotate(180deg)':''}"
                    >
                      ▼
                    </div>
                  </div>
                </template>
                <v-list class="dropdown-background">
                  <v-list-item style="min-height: 32px">
                    <router-link
                      to="/baccalaureate"
                      class="header-link"
                    >
                      Бакалавриат
                    </router-link>
                  </v-list-item>
                  <v-list-item style="min-height: 32px">
                    <router-link
                      to="/magistracy"
                      class="header-link"
                    >
                      Магистратура
                    </router-link>
                  </v-list-item>
                </v-list>
              </v-menu>
            </div>
          </template>
        </v-col>

        <v-col
          :style="{opacity:show||$vuetify.breakpoint.mdAndUp?1:0,zIndex:show|| $vuetify.breakpoint.mdAndUp?1:-1}"
          style="transition: all .4s"
          cols="2"
          md="1"
        >
          <SwitchComponent class="ml-lg-4" />
        </v-col>

        <v-spacer />

        <v-col
          v-if="$vuetify.breakpoint.smAndDown"
          cols="4"
          class="d-flex justify-end"
        >
          <div
            class="menu"
            @click="clickMenu"
          >
            <div class="bar" />
            <div class="bar" />
            <div class="bar" />
          </div>
        </v-col>

        <v-col
          v-if="$vuetify.breakpoint.smAndDown"
          cols="12 "
          class="pa-0"
        >
          <v-expand-transition>
            <v-list
              v-show="show"
              class="app-background"
            >
              <template
                v-for="(link,i) in links"
              >
                <v-list-item
                  v-if="i!==3"
                  :key="i"
                  style="min-height: 33px"
                  class="d-flex justify-center"
                  @click="closeMenu"
                >
                  <router-link
                    :to="'/'+link.path"
                    class="header-link text-center"
                    style="width: 100%"
                    :class="link.name.filter(x=>x===$route.name).length>0?'link--active':''"
                  >
                    {{ link.text }}
                  </router-link>
                </v-list-item>
                <v-list-item
                  v-else
                  :key="i"
                  style="min-height: 33px"
                  class="d-flex justify-center align-start pt-1"
                >
                  <div>
                    <div
                      class="header-link d-flex align-center justify-center"
                      @click="symbol=!symbol"
                    >
                      <span
                        class="pr-1"
                        :class="['baccalaureate','magistracy','program','disciplines'].filter(x=>x===$route.name).length>0?'link--active':''"
                      >Поступление</span>
                      <div
                        class="dropdown-symbol"
                        :style="{transform:symbol?'rotate(180deg)':''}"
                      >
                        ▼
                      </div>
                    </div>
                    <v-expand-transition>
                      <v-list
                        v-show="symbol"
                        class="app-background"
                      >
                        <v-list-item
                          style="min-height: 33px"
                          class="d-flex justify-center"
                          @click="closeMenu"
                        >
                          <router-link
                            to="/baccalaureate"
                            class="header-link text-center"
                            style="width: 100%"
                          >
                            Бакалавриат
                          </router-link>
                        </v-list-item>
                        <v-list-item
                          style="min-height: 33px"
                          class="d-flex justify-center"
                          @click="closeMenu"
                        >
                          <router-link
                            to="/magistracy"
                            class="header-link text-center"
                            style="width: 100%"
                          >
                            Магистратура
                          </router-link>
                        </v-list-item>
                      </v-list>
                    </v-expand-transition>
                  </div>
                </v-list-item>
              </template>
            </v-list>
          </v-expand-transition>
        </v-col>
      </v-row>
    </v-container>
  </div>
</template>

<script>
import { mapState } from 'vuex'

export default {
  name: 'TheHeaderComponent',
  components: { SwitchComponent: () => import('@/components/app/SwitchComponent') },
  data: () => ({
    symbol: false, show: false,
    links: [
      { text: 'Главная', name: ['home'], path: '' },
      { text: 'События', name: ['events', 'news', 'new', 'event', 'announcement'], path: 'events' },
      { text: 'Студентам', name: ['students'], path: 'students' },
      {},
      { text: 'Контакты', name: ['contacts'], path: 'contacts' }
    ]
  }),
  computed: mapState('app', ['theme']),
  created() {
    window.addEventListener('scroll', this.handleScroll)
  },
  destroyed() {
    window.removeEventListener('scroll', this.handleScroll)
  },
  methods: {
    handleScroll() {
      let { top } = document.body.getBoundingClientRect()
      if (top === 0) {
        document.querySelector('.navbar-container').classList.remove('shadow')
      } else {
        document.querySelector('.navbar-container').classList.add('shadow')
      }
    },
    closeMenu() {
      document.querySelector('.menu').classList.remove('active')
      this.show = false
    },
    clickMenu() {
      document.querySelector('.menu').classList.toggle('active')
      this.show = !this.show
    }
  }
}
</script>

<style lang="scss" scoped>
@import "../../styles/colors";

.navbar-container {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 100
}

.navbar-container.shadow {
  box-shadow: 0 5px 5px -5px #333;
}

.header-link {
  text-decoration: none;
  font-size: 24px;
  @media (max-width: 1904px) {
    font-size: 18px;
  }
  @media (max-width: 1264px) {
    font-size: 14px;
  }
  @media (max-width: 960px) {
    font-size: 18px;
  }
}

.header-link:hover {
  text-decoration: none;
}

.link--active {
  color: $ict-blue-green !important;
}

.logo {
  height: 3rem;
  @media (min-width: 1904px) {
    height: 4rem;
  }
}
</style>